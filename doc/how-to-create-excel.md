
# 如何添加表头？
导表工具支持两种导表方式，直接模式(Direct)和配置模式(Config)。需要根据自己项目的情况，选择合适的模式。

# 1.直接模式
直接模式下，程序使用的字段名(field)和字段类型，都由表头提供。

![](images/direct-header@2x.png)

Excel行 | 描述
--------|---------
 1      | 表格属性。可以描述表格版本，键值是否唯一，表格描述等参数。
 2      | 预留。可以通过修改配置参数`SHEET_ROW_INDEX`，来移除改行。
 3      | 表头文字描述。建议保持唯一
 4      | 程序使用的字段名。必须唯一
 5      | 字段的类型。目前支持：int, long, float, boolean, String。复杂类型都会转成String类型。
 6      | 从该行开始，都是数据。数据的第一列为表格的键值(key)，key可以不唯一，但必须要在表格属性中指定。

## 表格属性
每两列为一组，每组第一列为描述，第二列为数值。

A   | B     | C     | D     | E     | F
----|-------|-------|-------|-------|---
版本：|100   | 键值是否重复：| 1 | 说明：| 这是一张测试表

如果要添加额外的表格属性，可以修改配置文件的`ARGUMENT_CONVERTER`

# 2.配置模式
配置模式下，程序使用的字段名和字段类型，都由脚本提供。表头只需要提供一行中文表头。



1. 在Excel表中，添加上“表头”，以及类型描述
2. 在转换器中的`CONFIG`字典中，添加上“表头”和代码中字段的对应关系，以及转换函数。

## 如何根据转换器配置为excel添加表头？
```shell
python main.py --gen-header your_configure_file
```

## 如何添加新Excel表？
1. 在`excels`路径下，新建Excel表，表内容格式如下：  

    行   | 描述
    ------|------
    第1行 | 预留
    第2行 | 预留
    第3行 | 表头
    第4行 | 基础类型描述。用于确定导表第一阶段数据类型。
    后续行 | 表格数据

    空白行或者列都是有效数据分割符，位于空白列右侧或空白行下侧，都会被导表工具忽略，因此可以存放注释或临时数据。

    通常**第1列**为数据的键值(key)。

2. 在`converter`目录下添加python转换器。转换器的详细写法，请参考`converter/example.py`。大致内容如下：
    ```python
    KEY_NAME = "ID"
    CONFIG = {
        ("编号", "ID", int),
        ("名称", "name", str),
        ("描述", "describe", str, True),
        ("品质", "quality", int, True, 0),
    }
    ```
    CONFIG是一个数组，描述了如何将excel表头转换成程序用的字段。

    数组索引 | 描述
    --------|------------
     0      | Excel表头文字
     1      | 程序使用的字段名
     2      | 转换函数。将excel表中的单元格转换成脚本对象。
     3      | 表示此列是否可缺省，即是否可不填。不指定表示为必填。
     4      | 缺省值。脚本中使用此值替代excel中没有填的位置，如果没有指定缺省值，脚本中就不会出现该单元格的数据。

3. 在`convention_table.py`文件中添加上Excel表与转换器的对应关系。
